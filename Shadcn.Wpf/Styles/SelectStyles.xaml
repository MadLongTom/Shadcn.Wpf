<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:system="clr-namespace:System;assembly=mscorlib"
                    xmlns:controls="clr-namespace:Shadcn.Wpf.Controls">

    <!-- Fallback colors -->
    <SolidColorBrush x:Key="FallbackSelectBackgroundBrush">#FFFFFF</SolidColorBrush>
    <SolidColorBrush x:Key="FallbackSelectForegroundBrush">#020817</SolidColorBrush>
    <SolidColorBrush x:Key="FallbackSelectBorderBrush">#E2E8F0</SolidColorBrush>
    <SolidColorBrush x:Key="FallbackSelectFocusBorderBrush">#3B82F6</SolidColorBrush>
    <SolidColorBrush x:Key="FallbackSelectHoverBorderBrush">#CBD5E1</SolidColorBrush>
    <SolidColorBrush x:Key="FallbackSelectPlaceholderBrush">#64748B</SolidColorBrush>
    <SolidColorBrush x:Key="FallbackSelectItemHoverBrush">#F1F5F9</SolidColorBrush>
    <SolidColorBrush x:Key="FallbackSelectItemSelectedBrush">#EFF6FF</SolidColorBrush>
    <SolidColorBrush x:Key="FallbackSelectItemSelectedForegroundBrush">#1E40AF</SolidColorBrush>

    <!-- Select Item Template -->
    <ControlTemplate x:Key="ShadcnSelectItemTemplate"
            TargetType="{x:Type controls:ShadcnSelectItem}">
        <Border x:Name="PART_Border"
                Background="Transparent"
                Padding="{DynamicResource ComponentPaddingMd}"
                Cursor="Hand">
            <VisualStateManager.VisualStateGroups>
                <!-- Common States -->
                <VisualStateGroup x:Name="CommonStates">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="PART_ScaleTransform"
                                             Storyboard.TargetProperty="ScaleX"
                                             To="1"
                                             Duration="{DynamicResource AnimationFast}">
                                <DoubleAnimation.EasingFunction>
                                    <QuadraticEase EasingMode="EaseOut"/>
                                </DoubleAnimation.EasingFunction>
                            </DoubleAnimation>
                            <DoubleAnimation Storyboard.TargetName="PART_ScaleTransform"
                                             Storyboard.TargetProperty="ScaleY"
                                             To="1"
                                             Duration="{DynamicResource AnimationFast}">
                                <DoubleAnimation.EasingFunction>
                                    <QuadraticEase EasingMode="EaseOut"/>
                                </DoubleAnimation.EasingFunction>
                            </DoubleAnimation>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Border"
                                                           Storyboard.TargetProperty="Background">
                                <DiscreteObjectKeyFrame KeyTime="0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <SolidColorBrush Color="Transparent"/>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="MouseOver">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="PART_ScaleTransform"
                                             Storyboard.TargetProperty="ScaleX"
                                             To="1.02"
                                             Duration="{DynamicResource AnimationFast}">
                                <DoubleAnimation.EasingFunction>
                                    <QuadraticEase EasingMode="EaseOut"/>
                                </DoubleAnimation.EasingFunction>
                            </DoubleAnimation>
                            <DoubleAnimation Storyboard.TargetName="PART_ScaleTransform"
                                             Storyboard.TargetProperty="ScaleY"
                                             To="1.02"
                                             Duration="{DynamicResource AnimationFast}">
                                <DoubleAnimation.EasingFunction>
                                    <QuadraticEase EasingMode="EaseOut"/>
                                </DoubleAnimation.EasingFunction>
                            </DoubleAnimation>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Pressed">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="PART_ScaleTransform"
                                             Storyboard.TargetProperty="ScaleX"
                                             To="0.98"
                                             Duration="{DynamicResource AnimationFast}">
                                <DoubleAnimation.EasingFunction>
                                    <QuadraticEase EasingMode="EaseOut"/>
                                </DoubleAnimation.EasingFunction>
                            </DoubleAnimation>
                            <DoubleAnimation Storyboard.TargetName="PART_ScaleTransform"
                                             Storyboard.TargetProperty="ScaleY"
                                             To="0.98"
                                             Duration="{DynamicResource AnimationFast}">
                                <DoubleAnimation.EasingFunction>
                                    <QuadraticEase EasingMode="EaseOut"/>
                                </DoubleAnimation.EasingFunction>
                            </DoubleAnimation>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>

                <!-- Selection States -->
                <VisualStateGroup x:Name="SelectionStates">
                    <VisualState x:Name="Unselected"/>
                    <VisualState x:Name="Selected">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Border"
                                                           Storyboard.TargetProperty="Background">
                                <DiscreteObjectKeyFrame KeyTime="0"
                                        Value="{DynamicResource SelectItemSelectedBrush}"/>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>

            <Border.RenderTransform>
                <ScaleTransform x:Name="PART_ScaleTransform"
                        ScaleX="1"
                        ScaleY="1"/>
            </Border.RenderTransform>
            <Border.RenderTransformOrigin>
                <Point X="0.5"
                        Y="0.5"/>
            </Border.RenderTransformOrigin>

            <ContentPresenter x:Name="PART_ContentPresenter"
                              Content="{TemplateBinding Content}"
                              ContentTemplate="{TemplateBinding ContentTemplate}"
                              TextElement.Foreground="{TemplateBinding Foreground}"
                              VerticalAlignment="Center"
                              HorizontalAlignment="Left"/>
        </Border>
    </ControlTemplate>

    <!-- Select Control Template -->
    <ControlTemplate x:Key="ShadcnSelectTemplate"
            TargetType="{x:Type controls:ShadcnSelect}">
        <Grid>
            <VisualStateManager.VisualStateGroups>
                <!-- Common States -->
                <VisualStateGroup x:Name="CommonStates">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="PART_MainTransform"
                                             Storyboard.TargetProperty="ScaleX"
                                             To="1"
                                             Duration="{DynamicResource AnimationFast}">
                                <DoubleAnimation.EasingFunction>
                                    <QuadraticEase EasingMode="EaseOut"/>
                                </DoubleAnimation.EasingFunction>
                            </DoubleAnimation>
                            <DoubleAnimation Storyboard.TargetName="PART_MainTransform"
                                             Storyboard.TargetProperty="ScaleY"
                                             To="1"
                                             Duration="{DynamicResource AnimationFast}">
                                <DoubleAnimation.EasingFunction>
                                    <QuadraticEase EasingMode="EaseOut"/>
                                </DoubleAnimation.EasingFunction>
                            </DoubleAnimation>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="MouseOver"/>
                    <VisualState x:Name="Pressed"/>
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="PART_ToggleButton"
                                             Storyboard.TargetProperty="Opacity"
                                             To="0.5"
                                             Duration="{DynamicResource AnimationFast}"/>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>

                <!-- Focus States -->
                <VisualStateGroup x:Name="FocusStates">
                    <VisualState x:Name="Unfocused">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="PART_MainTransform"
                                             Storyboard.TargetProperty="ScaleX"
                                             To="1"
                                             Duration="{DynamicResource AnimationFast}">
                                <DoubleAnimation.EasingFunction>
                                    <QuadraticEase EasingMode="EaseOut"/>
                                </DoubleAnimation.EasingFunction>
                            </DoubleAnimation>
                            <DoubleAnimation Storyboard.TargetName="PART_MainTransform"
                                             Storyboard.TargetProperty="ScaleY"
                                             To="1"
                                             Duration="{DynamicResource AnimationFast}">
                                <DoubleAnimation.EasingFunction>
                                    <QuadraticEase EasingMode="EaseOut"/>
                                </DoubleAnimation.EasingFunction>
                            </DoubleAnimation>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Focused">
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="PART_MainTransform"
                                             Storyboard.TargetProperty="ScaleX"
                                             To="1.02"
                                             Duration="{DynamicResource AnimationFast}">
                                <DoubleAnimation.EasingFunction>
                                    <QuadraticEase EasingMode="EaseOut"/>
                                </DoubleAnimation.EasingFunction>
                            </DoubleAnimation>
                            <DoubleAnimation Storyboard.TargetName="PART_MainTransform"
                                             Storyboard.TargetProperty="ScaleY"
                                             To="1.02"
                                             Duration="{DynamicResource AnimationFast}">
                                <DoubleAnimation.EasingFunction>
                                    <QuadraticEase EasingMode="EaseOut"/>
                                </DoubleAnimation.EasingFunction>
                            </DoubleAnimation>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>

                <!-- Dropdown States - Removed arrow animation from here -->
                <VisualStateGroup x:Name="DropdownStates">
                    <VisualState x:Name="Closed"/>
                    <VisualState x:Name="Open"/>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>

            <Grid.RenderTransform>
                <ScaleTransform x:Name="PART_MainTransform"
                        ScaleX="1"
                        ScaleY="1"
                        CenterX="0.5"
                        CenterY="0.5"/>
            </Grid.RenderTransform>
            <Grid.RenderTransformOrigin>
                <Point X="0.5"
                        Y="0.5"/>
            </Grid.RenderTransformOrigin>

            <!-- Main Toggle Button -->
            <ToggleButton x:Name="PART_ToggleButton"
                          Background="{DynamicResource SelectBackgroundBrush}"
                          BorderBrush="{DynamicResource SelectBorderBrush}"
                          BorderThickness="{DynamicResource BorderThin}"
                          Padding="{DynamicResource ComponentPaddingMd}"
                          MinHeight="{DynamicResource ControlHeightMd}"
                          IsChecked="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay}"
                          IsEnabled="{Binding IsEnabled, RelativeSource={RelativeSource TemplatedParent}}"
                          Focusable="True">
                <ToggleButton.Template>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border x:Name="PART_Border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="{DynamicResource RadiusMd}"
                                Padding="{TemplateBinding Padding}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- Content Area -->
                                <ContentPresenter x:Name="PART_ContentPresenter"
                                                  Grid.Column="0"
                                                  VerticalAlignment="Center"
                                                  HorizontalAlignment="Left"
                                                  RecognizesAccessKey="False"
                                                  TextElement.Foreground="{DynamicResource SelectForegroundBrush}"
                                                  Visibility="Visible"/>

                                <!-- Placeholder Text -->
                                <TextBlock x:Name="PART_Placeholder"
                                           Grid.Column="0"
                                           Text="{Binding Placeholder, RelativeSource={RelativeSource AncestorType=controls:ShadcnSelect}}"
                                           Foreground="{DynamicResource SelectPlaceholderBrush}"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Left"
                                           IsHitTestVisible="False"
                                           Visibility="Collapsed"/>

                                <!-- Dropdown Arrow -->
                                <Path x:Name="PART_Arrow"
                                      Grid.Column="1"
                                      Data="M 0 0 L 4 4 L 8 0 Z"
                                      Fill="{DynamicResource SelectForegroundBrush}"
                                      VerticalAlignment="Center"
                                      HorizontalAlignment="Center"
                                      Margin="{DynamicResource SpacingLeftSm}">
                                    <Path.RenderTransform>
                                        <RotateTransform x:Name="PART_ArrowRotation"
                                                Angle="0"
                                                CenterX="4"
                                                CenterY="2"/>
                                    </Path.RenderTransform>
                                </Path>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <!-- Show placeholder when no item is selected -->
                            <DataTrigger Binding="{Binding SelectedItem, RelativeSource={RelativeSource AncestorType=controls:ShadcnSelect}}"
                                    Value="{x:Null}">
                                <Setter TargetName="PART_Placeholder"
                                        Property="Visibility"
                                        Value="Visible"/>
                                <Setter TargetName="PART_ContentPresenter"
                                        Property="Visibility"
                                        Value="Collapsed"/>
                            </DataTrigger>

                            <!-- Hover effects -->
                            <Trigger Property="IsMouseOver"
                                    Value="True">
                                <Setter TargetName="PART_Border"
                                        Property="BorderBrush"
                                        Value="{DynamicResource SelectHoverBorderBrush}"/>
                            </Trigger>

                            <!-- Focus effects -->
                            <Trigger Property="IsFocused"
                                    Value="True">
                                <Setter TargetName="PART_Border"
                                        Property="BorderBrush"
                                        Value="{DynamicResource SelectFocusBorderBrush}"/>
                            </Trigger>

                            <!-- Dropdown open state -->
                            <Trigger Property="IsChecked"
                                    Value="True">
                                <Setter TargetName="PART_Border"
                                        Property="BorderBrush"
                                        Value="{DynamicResource SelectFocusBorderBrush}"/>
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="PART_ArrowRotation"
                                                             Storyboard.TargetProperty="Angle"
                                                             To="180"
                                                             Duration="0:0:0.2">
                                                <DoubleAnimation.EasingFunction>
                                                    <QuadraticEase EasingMode="EaseOut"/>
                                                </DoubleAnimation.EasingFunction>
                                            </DoubleAnimation>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="PART_ArrowRotation"
                                                             Storyboard.TargetProperty="Angle"
                                                             To="0"
                                                             Duration="0:0:0.2">
                                                <DoubleAnimation.EasingFunction>
                                                    <QuadraticEase EasingMode="EaseOut"/>
                                                </DoubleAnimation.EasingFunction>
                                            </DoubleAnimation>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </ToggleButton.Template>
            </ToggleButton>

            <!-- Dropdown Popup -->
            <Popup x:Name="PART_Popup"
                   PlacementTarget="{Binding ElementName=PART_ToggleButton}"
                   Placement="Bottom"
                   IsOpen="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}"
                   StaysOpen="False"
                   AllowsTransparency="True"
                   PopupAnimation="Fade"
                   Focusable="False">
                <Border x:Name="PART_PopupBorder"
                        Background="{DynamicResource SelectBackgroundBrush}"
                        BorderBrush="{DynamicResource SelectBorderBrush}"
                        BorderThickness="{DynamicResource BorderThin}"
                        CornerRadius="{DynamicResource RadiusMd}"
                        MinWidth="{Binding ActualWidth, ElementName=PART_ToggleButton}"
                        MaxHeight="{Binding MaxDropDownHeight, RelativeSource={RelativeSource TemplatedParent}}"
                        Effect="{DynamicResource DropShadowEffect}">

                    <ScrollViewer x:Name="PART_ScrollViewer"
                                  VerticalScrollBarVisibility="Auto"
                                  HorizontalScrollBarVisibility="Disabled"
                                  Margin="{DynamicResource SpacingLeftXs}">
                        <ItemsPresenter x:Name="PART_ItemsPresenter"/>
                    </ScrollViewer>
                </Border>
            </Popup>
        </Grid>
    </ControlTemplate>

    <!-- Default Select Item Style -->
    <Style TargetType="{x:Type controls:ShadcnSelectItem}">
        <Setter Property="Template"
                Value="{StaticResource ShadcnSelectItemTemplate}"/>
        <Setter Property="Foreground"
                Value="{DynamicResource SelectForegroundBrush}"/>
        <Setter Property="FontFamily"
                Value="{DynamicResource DefaultFontFamily}"/>
        <Setter Property="FontSize"
                Value="{DynamicResource FontSizeBase}"/>
        <Setter Property="Margin"
                Value="{DynamicResource Spacing0}"/>
        <Style.Triggers>
            <Trigger Property="IsSelected"
                    Value="True">
                <Setter Property="Foreground"
                        Value="{DynamicResource SelectItemSelectedForegroundBrush}"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- Default Select Style -->
    <Style TargetType="{x:Type controls:ShadcnSelect}">
        <Setter Property="Template"
                Value="{StaticResource ShadcnSelectTemplate}"/>
        <Setter Property="Background"
                Value="{DynamicResource SelectBackgroundBrush}"/>
        <Setter Property="Foreground"
                Value="{DynamicResource SelectForegroundBrush}"/>
        <Setter Property="BorderBrush"
                Value="{DynamicResource SelectBorderBrush}"/>
        <Setter Property="BorderThickness"
                Value="{DynamicResource BorderThin}"/>
        <Setter Property="FontFamily"
                Value="{DynamicResource DefaultFontFamily}"/>
        <Setter Property="FontSize"
                Value="{DynamicResource FontSizeBase}"/>
        <Setter Property="MinHeight"
                Value="{DynamicResource ControlHeightMd}"/>
        <Setter Property="Cursor"
                Value="Hand"/>
        <Setter Property="Focusable"
                Value="True"/>
        <Setter Property="MaxDropDownHeight"
                Value="{DynamicResource Space20}"/>
    </Style>

</ResourceDictionary>
